<!DOCTYPE html>
<script>
   function toggle_display(val) {
   
       el = document.querySelector('.ABC' + val);
       console.log('.ABC' + val);
   
       if (el.style.display == 'none') {
           el.style.display = 'block';
       } else {
           el.style.display = 'none';
       }
   }
</script>
{% extends 'base.html' %}
{% block scripts %}
{{ super() }}
{{ datepicker.loader(theme="blitzer") }} {# to load jQuery-ui #}
{{ datepicker.picker(id=".dp",dateFormat='yy-mm-dd') }}
{% endblock %}
{% block title %} Search Results {% endblock %} {%
block content %}
<div class="main-container">
   <div class="search-result-wrapper">
      <div class="search-results-container" id="style-12">
         {% set count = namespace(value=0) %} 
         {% if results is defined and results|length > 0 %}

         {% for x in results %}
         <div class="article-wrapper">
            <h3>{{x['Title']}}</h3>
            <h6>Source: {{x['DB']}}</h6>
            {% if x['Summary']%}
            <section class="ABC{{count.value}}" id="style-12" style="display: none; overflow-y: scroll; max-height: 100px;">
               <h6>{{x['Summary']}}</h6>
            </section>
            <button class="btn btn-outline-primary fs-5 fw-bold" onclick="toggle_display({{count.value}})">
            Show abstract
            </button>
            {% endif %}
            <form action="#" method="post">
               <input type="text" class="btn-check" name="info" value="{{count.value}}" />
               <button class="btn btn-outline-primary fs-5 fw-bold" type="submit" value="submit">
               More information
               </button>
               {% set count.value = count.value + 1 %}
            </form>
         </div>
         {% endfor %}
         {% else %}
         <div class="search-failed-wrapper">
          <h2> No results found </h2>
          
            <a type="button" class="btn btn-primary btn-lg"  href="/"> Back to searchbar</a>
            {% if searchURL %}
            <a type="button" class="btn btn-primary btn-lg"  href={{searchURL}}> Back to searchresults</a>
            {% endif %}

          </div>
          {% endif %}
      </div>
   </div>
   {% if results is defined and results|length > 0 %}
   <div class="side-panel-container">
      <div class="side-panel-wrapper1">
         <article>
         <h2>Search results for:</h2>
         <br />
         <h3> "{{txt}}"          {% if startDate %}
          between</br>
          {{startDate}} 
          and 
          {{endDate}}
          {% endif %}</h3> 

         </aritcle>
      </div>
      <div class="side-panel-wrapper2">
         <h3> Select a date range </h3>
         <form action="" method='POST' name="myform">
            <section>
               {{ form.csrf_token }}
               <b>{{ form.startDate.label }}</b><br/>
               {{form.startDate(class='datepicker')}}
               {{form.hidden_tag()}}
            </section>
            <section>
               <b>{{form.endDate.label}}</b><br/>
               {{form.endDate(class='datepicker', default=endDate)}} 
               {{form.hidden_tag()}}
            </section>
            <button class="btn btn-outline-primary fs-5 fw-bold" type="Submit" value="Submit" onSubmit={{form.submit()}}
                Submit
            </button>
         </form>
           <a type="button" class="btn btn-primary btn-lg"  href="{{url_for('searchResults',txt=txt,hep=hep,arxiv=arxiv,filters=1)}}"> Clear filters</a>
         
      </div>
   </div>
   {% endif %}
</div>
{% endblock %}